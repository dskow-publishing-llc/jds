<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
     http://maven.apache.org/xsd/maven-4.0.0.xsd">

	<parent>
		<groupId>com.dskow</groupId>
		<artifactId>downloader</artifactId>
		<version>1.0</version>
		<relativePath>../pom.xml</relativePath>
	</parent>

	<modelVersion>4.0.0</modelVersion>
	<artifactId>downloader-common-models</artifactId>
	<packaging>jar</packaging>
	<name>JournalDoc Downloader Common Models</name>

	<properties>
		<root-path>${basedir}/..</root-path>
	</properties>

	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
			<scope>provided</scope>
			<exclusions>
				<exclusion>
					<groupId>org.springframework.boot</groupId>
					<artifactId>spring-boot-starter-tomcat</artifactId>
				</exclusion>
			</exclusions>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-mongodb</artifactId>
			<scope>provided</scope>
		</dependency>

		<!-- SpringFox dependencies -->
		<dependency>
			<groupId>io.springfox</groupId>
			<artifactId>springfox-swagger2</artifactId>
			<version>${springfox.version}</version>
		</dependency>

		<dependency>
			<groupId>com.fasterxml.jackson.jaxrs</groupId>
			<artifactId>jackson-jaxrs-json-provider</artifactId>
		</dependency>
		
		<!-- autogenerated stub dependencies -->
		<dependency>
			<groupId>io.swagger</groupId>
			<artifactId>swagger-annotations</artifactId>
			<version>${swagger.version}</version>
		</dependency>
		<dependency>
			<groupId>com.squareup.okhttp</groupId>
			<artifactId>okhttp</artifactId>
			<version>${okhttp.version}</version>
		</dependency>
		<dependency>
			<groupId>com.squareup.okhttp</groupId>
			<artifactId>logging-interceptor</artifactId>
			<version>${okhttp.version}</version>
		</dependency>
		<dependency>
			<groupId>com.google.code.gson</groupId>
			<artifactId>gson</artifactId>
		</dependency>
		<!-- end autogenerated stub dependencies -->
		
	</dependencies>

	<profiles>
		<profile>
			<id>buildswagger</id>
			<build>
				<plugins>
					<plugin>
						<groupId>com.github.kongchen</groupId>
						<artifactId>swagger-maven-plugin</artifactId>
						<version>${swagger-maven-plugin.version}</version>

						<configuration>
							<apiSources>
								<apiSource>
									<springmvc>false</springmvc>
									<locations>
										<location>com.dskow.downloader.service.jds.api</location>
										<location>com.dskow.downloader.models.service</location>
									</locations>
									<outputPath>${basedir}/target/generated/swagger/downloader/document.html</outputPath>
									<swaggerDirectory>${basedir}/target/generated/swagger/downloader</swaggerDirectory>

									<info>
										<title>JournalDoc Downloader Services</title>
										<version>${jdd.version}</version>
										<!-- description element is in markdown format -->
										<description>The Downloader permits new data sources to be registered on the fly without modifications to source code. Each registration call will include a schema that describes the nature of the data to be provided.</description>
										<!-- TODO <termsOfService>http://www.github.com/kongchen/swagger-maven-plugin</termsOfService> -->
										<contact>
											<email>david@dskow.com</email>
											<name>David Skowronski</name>
											<url>http://www.dskow.com/</url>
										</contact>
										<!-- TODO <license> <url></url> <name></name> </license> -->
									</info>

									<schemes>http,https</schemes>
									<host>localhost:8080</host>
									<basePath>/downloader</basePath>
								</apiSource>
							</apiSources>
						</configuration>
						<executions>
							<execution>
								<phase>process-classes</phase>
								<goals>
									<goal>generate</goal>
								</goals>
							</execution>
						</executions>
					</plugin>

					<plugin>
						<artifactId>maven-resources-plugin</artifactId>
						<version>${maven-resources-plugin.version}</version>
						<executions>
							<execution>
								<id>add-swagger-descriptors</id>
								<phase>prepare-package</phase>
								<goals>
									<goal>copy-resources</goal>
								</goals>
								<configuration>
									<outputDirectory>${project.build.outputDirectory}</outputDirectory>
									<resources>
										<resource>
											<directory>${root-path}/services/service-api/target/generated/swagger</directory>
											<targetPath>swagger-descriptors</targetPath>
											<filtering>false</filtering>
										</resource>
									</resources>
								</configuration>
							</execution>
						</executions>
					</plugin>

					<plugin>
						<artifactId>maven-jar-plugin</artifactId>
						<version>${maven.jar.plugin.version}</version>
						<configuration>
							<archive>
								<manifestFile>${project.build.outputDirectory}/META-INF/MANIFEST.MF</manifestFile>
							</archive>
						</configuration>
					</plugin>

					<plugin>
						<groupId>org.apache.felix</groupId>
						<artifactId>maven-bundle-plugin</artifactId>
						<version>${maven.bundle.plugin.version}</version>
						<extensions>true</extensions>
						<configuration>
							<instructions>
								<Bundle-SymbolicName>${project.artifactId}</Bundle-SymbolicName>
								<Bundle-Name>${project.name}</Bundle-Name>
								<Import-Package>*</Import-Package>
								<Export-Package>
									io.swagger.annotations,
									javax.ws.rs,
									org.apache.commons.lang3,
									org.springframework.data.annotation,
									*
								</Export-Package>
							</instructions>

						</configuration>
						<executions>
							<execution>
								<id>bundle-manifest</id>
								<phase>process-classes</phase>
								<goals>
									<goal>manifest</goal>
								</goals>
							</execution>
						</executions>
					</plugin>

				</plugins>
			</build>
		</profile>
	</profiles>



</project>
